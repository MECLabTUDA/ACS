Device name: cuda:0
Experiment name: kd_lambda_1_ne

DATASET: DecathlonHippocampus with 260 instances
Mean shape: (1, 35, 49, 35), shape std: (0, 1, 3, 4)
Mask labels: ['background', 'hippocampus']


DATASET: DryadHippocampus[Modality:T1w][Resolution:Standard] with 50 instances
Mean shape: (1, 48, 64, 64), shape std: (0, 0, 0, 0)
Mask labels: ['background', 'hippocampus']


DATASET: HarP[Part:All] with 226 instances
Mean shape: (1, 48, 64, 64), shape std: (0, 0, 0, 0)
Mask labels: ['background', 'hippocampus']

Dividing dataset
Repetition k 1 of 1
Repetition k 1 of 1
Repetition k 1 of 1


Using GPUs: [0]
{'experiment_name': 'kd_lambda_1_ne', 'nr_runs': 1, 'device': 'cuda:0', 'device_ids': [0], 'n_workers': 2, 'test_ratio': 0.2, 'val_ratio': 0.125, 'input_dim_c': 1, 'input_dim_hw': 256, 'no_resize': False, 'augmentation': 'none', 'n_samples': None, 'sampler': False, 'combination': 0, 'epochs': 60, 'lr': 0.0002, 'lr_2': 0.0001, 'batch_size': 40, 'domain_code_size': 4, 'cross_validation': False, 'd_iter': 1, 'eval_interval': 7, 'save_interval': 1, 'display_interval': 1, 'resume_epoch': None, 'lambda_vae': 5, 'lambda_c_adv': 1, 'lambda_lcr': 0.0001, 'lambda_seg': 5, 'lambda_c_recon': 0, 'lambda_gan': 5, 'lambda_d': 1.0, 'eval': False, 'lambda_eval': True, 'unet_only': False, 'unet_dropout': 0, 'unet_monte_carlo_dropout': 0, 'unet_preactivation': False, 'single_ds': False, 'input_shape': (1, 256, 256), 'class_weights': (0.0, 1.0)}

running loss: 1.3648310001582316 - distill 0.0 - time/epoch 111.4596

running loss: 1.1052844127019246 - distill 0.0 - time/epoch 111.4677

running loss: 0.8983493577944089 - distill 0.0 - time/epoch 110.6754

running loss: 0.7640067458697105 - distill 0.0 - time/epoch 111.2591

running loss: 0.6665893031037562 - distill 0.0 - time/epoch 111.2649

running loss: 0.6054463103481623 - distill 0.0 - time/epoch 110.9547

running loss: 0.570878560820671 - distill 0.0 - time/epoch 111.4256

running loss: 0.5340260622436053 - distill 0.0 - time/epoch 111.1341

running loss: 0.528611584341145 - distill 0.0 - time/epoch 111.3452

running loss: 0.5341573692347905 - distill 0.0 - time/epoch 111.3311

running loss: 0.502373353327246 - distill 0.0 - time/epoch 110.6627

running loss: 0.49398009689975547 - distill 0.0 - time/epoch 110.7434

running loss: 0.4840942889315897 - distill 0.0 - time/epoch 111.2489

running loss: 0.4738994018264013 - distill 0.0 - time/epoch 110.9243

running loss: 0.4670798901009233 - distill 0.0 - time/epoch 111.0606

running loss: 0.46195125668288367 - distill 0.0 - time/epoch 110.6284

running loss: 0.4572542432236345 - distill 0.0 - time/epoch 111.0553

running loss: 0.4400469308302283 - distill 0.0 - time/epoch 110.9475

running loss: 0.38297742020049597 - distill 0.0 - time/epoch 110.7715

running loss: 0.2788181181775925 - distill 0.0 - time/epoch 110.3582

running loss: 0.22142421981515406 - distill 0.0 - time/epoch 110.6618

running loss: 0.21024181809463457 - distill 0.0 - time/epoch 110.9298

running loss: 0.21315246391786288 - distill 0.0 - time/epoch 110.912

running loss: 0.19599311604891737 - distill 0.0 - time/epoch 110.8706

running loss: 0.19011911195298853 - distill 0.0 - time/epoch 110.7265

running loss: 0.18397361336097326 - distill 0.0 - time/epoch 110.8405

running loss: 0.17828770233615893 - distill 0.0 - time/epoch 111.1287

running loss: 0.19961726236833285 - distill 0.0 - time/epoch 111.3025

running loss: 0.17494643687113234 - distill 0.0 - time/epoch 111.1337

running loss: 0.17180422110032273 - distill 0.0 - time/epoch 112.2034
Epoch 30 dataset ('DecathlonHippocampus', 'val')
LossClassWeighted[loss=LossCombined[1.0xLossDice[smooth=1.0]+1.0xLossBCE]; weights=(0.0, 1.0)]: 0.5174064866399518
LossCombined[1.0xLossDice[smooth=1.0]+1.0xLossBCE][0]: 0.19259966997758818
LossCombined[1.0xLossDice[smooth=1.0]+1.0xLossBCE][1]: 0.5174064866399518
ScoreDice: 0.8868530127613461
ScoreIoU: 0.8134058710843614
ScoreDice[background]: 0.9886457866497533
ScoreIoU[background]: 0.9775691765073116
ScoreDice[hippocampus]: 0.7850602388729387
ScoreIoU[hippocampus]: 0.6492425656614107
Epoch 30 dataset ('DryadHippocampus', 'val')
LossClassWeighted[loss=LossCombined[1.0xLossDice[smooth=1.0]+1.0xLossBCE]; weights=(0.0, 1.0)]: 0.29566910264547913
LossCombined[1.0xLossDice[smooth=1.0]+1.0xLossBCE][0]: 0.026134254341054586
LossCombined[1.0xLossDice[smooth=1.0]+1.0xLossBCE][1]: 0.29566910264547913
ScoreDice: 0.9308121156296263
ScoreIoU: 0.8781200102676738
ScoreDice[background]: 0.9967678990671294
ScoreIoU[background]: 0.9935574339629938
ScoreDice[hippocampus]: 0.864856332192123
ScoreIoU[hippocampus]: 0.7626825865723539
Epoch 30 dataset ('HarP', 'val')
LossClassWeighted[loss=LossCombined[1.0xLossDice[smooth=1.0]+1.0xLossBCE]; weights=(0.0, 1.0)]: 0.7487502536564337
LossCombined[1.0xLossDice[smooth=1.0]+1.0xLossBCE][0]: 0.10781872817545042
LossCombined[1.0xLossDice[smooth=1.0]+1.0xLossBCE][1]: 0.7487502536564337
ScoreDice: 0.7484441616065738
ScoreIoU: 0.6637169723136366
ScoreDice[background]: 0.9906236031466211
ScoreIoU[background]: 0.9814386484545817
ScoreDice[hippocampus]: 0.5062647200665269
ScoreIoU[hippocampus]: 0.3459952961726915
Finished training on A and B, starting training on C
Freezing everything but last 2 layers of segmentor
Using GPUs: [0]
{'experiment_name': 'kd_lambda_1_ne', 'nr_runs': 1, 'device': 'cuda:0', 'device_ids': [0], 'n_workers': 2, 'test_ratio': 0.2, 'val_ratio': 0.125, 'input_dim_c': 1, 'input_dim_hw': 256, 'no_resize': False, 'augmentation': 'none', 'n_samples': None, 'sampler': False, 'combination': 0, 'epochs': 60, 'lr': 0.0002, 'lr_2': 0.0001, 'batch_size': 40, 'domain_code_size': 4, 'cross_validation': False, 'd_iter': 1, 'eval_interval': 7, 'save_interval': 1, 'display_interval': 1, 'resume_epoch': None, 'lambda_vae': 5, 'lambda_c_adv': 1, 'lambda_lcr': 0.0001, 'lambda_seg': 5, 'lambda_c_recon': 0, 'lambda_gan': 5, 'lambda_d': 1.0, 'eval': False, 'lambda_eval': True, 'unet_only': False, 'unet_dropout': 0, 'unet_monte_carlo_dropout': 0, 'unet_preactivation': False, 'single_ds': False, 'input_shape': (1, 256, 256), 'class_weights': (0.0, 1.0)}

running loss: 1.3951708636435856 - distill 0.8787452615352266 - time/epoch 138.0192

running loss: 1.2882824499768566 - distill 0.7840174993433325 - time/epoch 134.9629
Traceback (most recent call last):
  File "/opt/conda/lib/python3.6/multiprocessing/queues.py", line 240, in _feed
    send_bytes(obj)
  File "/opt/conda/lib/python3.6/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/opt/conda/lib/python3.6/multiprocessing/connection.py", line 404, in _send_bytes
    self._send(header + buf)
  File "/opt/conda/lib/python3.6/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe

running loss: 1.2711915573275896 - distill 0.7708249027985501 - time/epoch 132.4505

running loss: 1.2801615899777508 - distill 0.7832325649451449 - time/epoch 131.9051

running loss: 1.3219103316861796 - distill 0.8266157818980426 - time/epoch 136.6413

running loss: 1.2698215557284565 - distill 0.7754876384459644 - time/epoch 138.5754

running loss: 1.24563412884792 - distill 0.7541905558441739 - time/epoch 138.2994

running loss: 1.2350902692730208 - distill 0.743410892458076 - time/epoch 138.8125

running loss: 1.27148761526047 - distill 0.7816724835401512 - time/epoch 138.5273

running loss: 1.2688991080717262 - distill 0.7799786510932968 - time/epoch 138.2452

running loss: 1.243205499601554 - distill 0.7544729981526911 - time/epoch 138.524

running loss: 1.2324453950878158 - distill 0.7496128969221001 - time/epoch 138.507

running loss: 1.2377404817546982 - distill 0.7524518099914034 - time/epoch 138.4725

running loss: 1.2222751046556874 - distill 0.745427007575434 - time/epoch 138.2769

running loss: 1.2919022820860266 - distill 0.8060417689412713 - time/epoch 138.4762

running loss: 1.2494404140221644 - distill 0.7662387196998672 - time/epoch 138.6418

running loss: 1.247544209083238 - distill 0.7642959374118137 - time/epoch 138.2219

running loss: 1.2100758362576307 - distill 0.7345812555803246 - time/epoch 138.722

running loss: 1.2324711934503807 - distill 0.7588335004935701 - time/epoch 138.7264

running loss: 1.2203123799833169 - distill 0.7444279523959673 - time/epoch 138.5251

running loss: 1.231004395570413 - distill 0.7565096900520096 - time/epoch 138.7372

running loss: 1.2334621486910786 - distill 0.7554580197628751 - time/epoch 138.1514

running loss: 1.2097480301837997 - distill 0.7393410779327986 - time/epoch 138.5715

running loss: 1.2168071374475244 - distill 0.744271895206307 - time/epoch 138.6168

running loss: 1.1728851472239095 - distill 0.7076057802395992 - time/epoch 138.5838

running loss: 1.19075897822817 - distill 0.7256400081740908 - time/epoch 138.3707

running loss: 1.1939552098631383 - distill 0.7242818472394905 - time/epoch 138.1049

running loss: 1.2183568810086802 - distill 0.749016987968726 - time/epoch 138.8234

running loss: 1.2313327599331678 - distill 0.7594654566025829 - time/epoch 138.6488

running loss: 1.1783961121779514 - distill 0.7117982813086643 - time/epoch 134.6074
Epoch 60 dataset ('DecathlonHippocampus', 'val')
LossClassWeighted[loss=LossCombined[1.0xLossDice[smooth=1.0]+1.0xLossBCE]; weights=(0.0, 1.0)]: 0.5794507921875746
LossCombined[1.0xLossDice[smooth=1.0]+1.0xLossBCE][0]: 0.2257274217529517
LossCombined[1.0xLossDice[smooth=1.0]+1.0xLossBCE][1]: 0.5794507921875746
ScoreDice: 0.8674844760470077
ScoreIoU: 0.7881386742575186
ScoreDice[background]: 0.9873578683159769
ScoreIoU[background]: 0.9750592801135343
ScoreDice[hippocampus]: 0.7476110837780385
ScoreIoU[hippocampus]: 0.6012180684015027
Epoch 60 dataset ('DryadHippocampus', 'val')
LossClassWeighted[loss=LossCombined[1.0xLossDice[smooth=1.0]+1.0xLossBCE]; weights=(0.0, 1.0)]: 0.3897164320573211
LossCombined[1.0xLossDice[smooth=1.0]+1.0xLossBCE][0]: 0.027101523152188278
LossCombined[1.0xLossDice[smooth=1.0]+1.0xLossBCE][1]: 0.3897164320573211
ScoreDice: 0.9284278271180211
ScoreIoU: 0.8743619577396908
ScoreDice[background]: 0.9966852521029527
ScoreIoU[background]: 0.9933931385187329
ScoreDice[hippocampus]: 0.8601704021330896
ScoreIoU[hippocampus]: 0.7553307769606487
Epoch 60 dataset ('HarP', 'val')
LossClassWeighted[loss=LossCombined[1.0xLossDice[smooth=1.0]+1.0xLossBCE]; weights=(0.0, 1.0)]: 0.7313625624494465
LossCombined[1.0xLossDice[smooth=1.0]+1.0xLossBCE][0]: 0.06800570671055671
LossCombined[1.0xLossDice[smooth=1.0]+1.0xLossBCE][1]: 0.7313625624494465
ScoreDice: 0.7616207005883516
ScoreIoU: 0.6759601453341402
ScoreDice[background]: 0.9917418308958683
ScoreIoU[background]: 0.9836294187056019
ScoreDice[hippocampus]: 0.5314995702808352
ScoreIoU[hippocampus]: 0.36829087196267823
Finished training on C
